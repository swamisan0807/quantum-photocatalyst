<!-- templates/index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quantum Photocatalyst Optimizer</title>
  <style>
    :root{
      --bg1:#060612;--panel:#071225;--accent1:#00d8ff;--accent2:#ff00d4;
      --glass: rgba(255,255,255,0.04);--muted:#9fb7d8;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#060612 0%, #081229 100%);font-family:Inter,system-ui,Segoe UI,Roboto,Arial;color:#cfefff;}
    .grid-bg{position:fixed;inset:0; background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px); background-size: 60px 60px; opacity:0.9; z-index:-1;}
    header{padding:28px 24px;text-align:center}
    h1{font-family: 'Orbitron', sans-serif; font-size:34px; margin:0; background:linear-gradient(90deg,var(--accent1),var(--accent2)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; letter-spacing:1px;}
    .subtitle{color:var(--muted); margin-top:6px}
    .stats-bar{display:flex;justify-content:center;gap:30px;margin-top:15px;flex-wrap:wrap}
    .stat-item{text-align:center;padding:10px 20px;background:rgba(0,216,255,0.08);border-radius:8px;border:1px solid rgba(0,216,255,0.2)}
    .stat-value{font-size:24px;font-weight:700;color:var(--accent1)}
    .stat-label{font-size:12px;color:var(--muted);margin-top:4px}
    .container{max-width:1200px;margin:24px auto;padding:0 18px; display:grid; grid-template-columns: 1fr 1fr; gap:22px;}
    .panel{background:var(--panel); border-radius:14px; padding:22px; box-shadow: 0 8px 30px rgba(0,0,0,0.6); border:1px solid rgba(0,216,255,0.06); position:relative}
    label{display:block;margin:10px 0 6px;color:#bfeaff;font-weight:500}
    select,input[type=range]{width:100%; padding:10px;border-radius:8px;border:1px solid rgba(0,216,255,0.2);background:var(--glass); color:#e6f9ff;font-size:14px}
    select{cursor:pointer;transition:all 0.3s ease}
    select:focus{outline:none;border-color:var(--accent1);box-shadow:0 0 0 3px rgba(0,216,255,0.1)}
    select[multiple]{height:160px; padding:8px; overflow:auto;background:rgba(7,18,37,0.8)}
    select[multiple] option{padding:6px 10px;margin:2px 0;border-radius:4px;cursor:pointer}
    select[multiple] option:hover{background:rgba(0,216,255,0.15)}
    select[multiple] option:checked{background:linear-gradient(90deg,rgba(0,216,255,0.3),rgba(255,0,212,0.3));font-weight:600}
    .btn{display:inline-block;margin-top:14px;padding:12px 18px;border-radius:10px;border:none;width:100%;cursor:pointer;font-weight:700;font-size:15px;background:linear-gradient(90deg,var(--accent1),var(--accent2)); color:#060612;box-shadow:0 6px 30px rgba(0,216,255,0.12);transition:transform 0.2s,box-shadow 0.2s}
    .btn:hover{transform:translateY(-2px);box-shadow:0 8px 35px rgba(0,216,255,0.25)}
    .btn:disabled{opacity:0.5;cursor:not-allowed;transform:none}
    .btn-secondary{background:linear-gradient(135deg,#1a2744,#2d4466);color:#00d8ff;margin-top:8px;font-size:14px;padding:10px}
    .circuit{min-height:320px;background:rgba(0,0,0,0.25); border-radius:10px; display:flex;align-items:center;justify-content:center;color:#84dfff;overflow:hidden;padding:15px}
    .circuit img{max-width:100%;max-height:100%;border-radius:8px}
    .results{margin-top:12px;background:rgba(255,255,255,0.02); padding:16px;border-radius:8px;color:#dff7ff;border:1px solid rgba(0,216,255,0.1)}
    .results strong{color:#00d8ff}
    .download-section{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    .download-btn{padding:12px;background:linear-gradient(135deg,#2a3f5f,#1a2f4f);border:1px solid rgba(0,216,255,0.3);border-radius:8px;color:#00d8ff;cursor:pointer;font-size:13px;font-weight:600;text-align:center;transition:all 0.3s;border:none}
    .download-btn:hover{background:linear-gradient(135deg,#3a5f8f,#2a4f7f);transform:translateY(-1px);box-shadow:0 4px 20px rgba(0,216,255,0.2)}
    .download-btn.excel{background:linear-gradient(135deg,#1e7145,#0d5c2f);border:1px solid rgba(0,255,128,0.3);color:#00ff80}
    .download-btn.excel:hover{background:linear-gradient(135deg,#2e9155,#1d7c4f);box-shadow:0 4px 20px rgba(0,255,128,0.2)}
    .hint{font-size:13px;color:#9fb7d8;margin-top:6px;font-style:italic}
    .select-all-btn{font-size:12px;padding:6px 14px;background:rgba(0,216,255,0.1);border:1px solid rgba(0,216,255,0.3);border-radius:5px;color:#00d8ff;cursor:pointer;margin-top:8px;display:inline-block;margin-right:8px;transition:all 0.3s}
    .select-all-btn:hover{background:rgba(0,216,255,0.2);transform:translateY(-1px)}
    .depth-info{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
    .depth-card{background:rgba(0,216,255,0.05);padding:10px;border-radius:6px;text-align:center;border:1px solid rgba(0,216,255,0.15)}
    .depth-card.active{border-color:var(--accent1);background:rgba(0,216,255,0.15)}
    .depth-level{font-size:16px;font-weight:700;color:var(--accent1)}
    .depth-qubits{font-size:12px;color:var(--muted);margin-top:4px}
    footer{text-align:center;color:#7f9fbf;padding:18px;font-size:14px}
    @media(max-width:900px){ 
      .container{grid-template-columns:1fr} 
      .circuit{min-height:240px}
      .download-section{grid-template-columns:1fr}
      .depth-info{grid-template-columns:repeat(2,1fr)}
      .stats-bar{gap:15px}
    }
  </style>
</head>
<body>
  <div class="grid-bg"></div>

  <header>
    <h1>‚öõÔ∏è Quantum Photocatalyst Optimizer</h1>
    <div class="subtitle">Advanced nanomaterial composites optimization with quantum computing simulation</div>
    <div class="stats-bar">
      <div class="stat-item">
        <div class="stat-value">150+</div>
        <div class="stat-label">Nanomaterials</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="selectedCount">0</div>
        <div class="stat-label">Selected Materials</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="qubitCount">15</div>
        <div class="stat-label">Qubits</div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="panel">
      <h3>üß™ Material Configuration</h3>

      <label>Choose Nanomaterials (Multi-select enabled)</label>
      <select id="materialType" multiple>
        <optgroup label="üî∑ Metal Oxides (50 materials)">
          <option value="TiO2" selected>Titanium Dioxide (TiO‚ÇÇ)</option>
          <option value="ZnO">Zinc Oxide (ZnO)</option>
          <option value="WO3">Tungsten Trioxide (WO‚ÇÉ)</option>
          <option value="BiVO4">Bismuth Vanadate (BiVO‚ÇÑ)</option>
          <option value="Fe2O3">Hematite (Fe‚ÇÇO‚ÇÉ)</option>
          <option value="Cu2O">Copper Oxide (Cu‚ÇÇO)</option>
          <option value="SnO2">Tin Dioxide (SnO‚ÇÇ)</option>
          <option value="NiO">Nickel Oxide (NiO)</option>
          <option value="Co3O4">Cobalt Oxide (Co‚ÇÉO‚ÇÑ)</option>
          <option value="In2O3">Indium Oxide (In‚ÇÇO‚ÇÉ)</option>
          <option value="CuO">Copper(II) Oxide (CuO)</option>
          <option value="CeO2">Ceria (CeO‚ÇÇ)</option>
          <option value="V2O5">Vanadium Pentoxide (V‚ÇÇO‚ÇÖ)</option>
          <option value="MnO2">Manganese Dioxide (MnO‚ÇÇ)</option>
          <option value="Nb2O5">Niobium Pentoxide (Nb‚ÇÇO‚ÇÖ)</option>
          <option value="ZrO2">Zirconia (ZrO‚ÇÇ)</option>
          <option value="Al2O3">Alumina (Al‚ÇÇO‚ÇÉ)</option>
          <option value="Ga2O3">Gallium Oxide (Ga‚ÇÇO‚ÇÉ)</option>
          <option value="Y2O3">Yttria (Y‚ÇÇO‚ÇÉ)</option>
          <option value="MgO">Magnesia (MgO)</option>
          <option value="GeO2">Germanium Oxide (GeO‚ÇÇ)</option>
          <option value="PbO">Lead Oxide (PbO)</option>
          <option value="VO2">Vanadium Dioxide (VO‚ÇÇ)</option>
          <option value="Cr2O3">Chromium Oxide (Cr‚ÇÇO‚ÇÉ)</option>
          <option value="NiCo2O4">Nickel Cobalt Oxide (NiCo‚ÇÇO‚ÇÑ)</option>
          <option value="ZnFe2O4">Zinc Ferrite (ZnFe‚ÇÇO‚ÇÑ)</option>
          <option value="CoFe2O4">Cobalt Ferrite (CoFe‚ÇÇO‚ÇÑ)</option>
          <option value="MnFe2O4">Manganese Ferrite (MnFe‚ÇÇO‚ÇÑ)</option>
          <option value="CuFe2O4">Copper Ferrite (CuFe‚ÇÇO‚ÇÑ)</option>
          <option value="NiFe2O4">Nickel Ferrite (NiFe‚ÇÇO‚ÇÑ)</option>
          <option value="Mn3O4">Manganese Oxide (Mn‚ÇÉO‚ÇÑ)</option>
          <option value="Fe3O4-NPs">Magnetite Nanoparticles</option>
          <option value="TiO2-P25">TiO‚ÇÇ P25</option>
          <option value="ZnO-NRs">ZnO Nanorods</option>
          <option value="WO3-NPs">WO‚ÇÉ Nanoparticles</option>
          <option value="SnO2-QDs">SnO‚ÇÇ Quantum Dots</option>
          <option value="CuO-NWs">CuO Nanowires</option>
          <option value="NiO-NPs">NiO Nanoparticles</option>
          <option value="TiO2-NT">TiO‚ÇÇ Nanotubes</option>
          <option value="ZnO-NWs">ZnO Nanowires</option>
          <option value="SrTiO3">Strontium Titanate (SrTiO‚ÇÉ)</option>
          <option value="BaTiO3">Barium Titanate (BaTiO‚ÇÉ)</option>
          <option value="Bi2WO6">Bismuth Tungstate (Bi‚ÇÇWO‚ÇÜ)</option>
          <option value="Bi2O3">Bismuth Oxide (Bi‚ÇÇO‚ÇÉ)</option>
          <option value="Ta2O5">Tantalum Pentoxide (Ta‚ÇÇO‚ÇÖ)</option>
          <option value="RuO2">Ruthenium Dioxide (RuO‚ÇÇ)</option>
          <option value="IrO2">Iridium Dioxide (IrO‚ÇÇ)</option>
          <option value="LaFeO3">Lanthanum Ferrite (LaFeO‚ÇÉ)</option>
          <option value="Fe3O4">Magnetite (Fe‚ÇÉO‚ÇÑ)</option>
        </optgroup>
        <optgroup label="‚ö° Sulfides & Selenides (25 materials)">
          <option value="CdS">Cadmium Sulfide (CdS)</option>
          <option value="CdSe">Cadmium Selenide (CdSe)</option>
          <option value="ZnS">Zinc Sulfide (ZnS)</option>
          <option value="Cu2S">Copper(I) Sulfide (Cu‚ÇÇS)</option>
          <option value="Sb2S3">Antimony Sulfide (Sb‚ÇÇS‚ÇÉ)</option>
          <option value="PbS">Lead Sulfide (PbS)</option>
          <option value="MoS2">Molybdenum Disulfide (MoS‚ÇÇ)</option>
          <option value="WS2">Tungsten Disulfide (WS‚ÇÇ)</option>
          <option value="SnS2">Tin Disulfide (SnS‚ÇÇ)</option>
          <option value="Bi2S3">Bismuth Sulfide (Bi‚ÇÇS‚ÇÉ)</option>
          <option value="ZnIn2S4">Zinc Indium Sulfide (ZnIn‚ÇÇS‚ÇÑ)</option>
          <option value="CuInS2">Copper Indium Sulfide (CuInS‚ÇÇ)</option>
          <option value="CdIn2S4">Cadmium Indium Sulfide (CdIn‚ÇÇS‚ÇÑ)</option>
          <option value="Ag2S">Silver Sulfide (Ag‚ÇÇS)</option>
          <option value="CuS">Copper Sulfide (CuS)</option>
          <option value="FeS2">Iron Pyrite (FeS‚ÇÇ)</option>
          <option value="In2S3">Indium Sulfide (In‚ÇÇS‚ÇÉ)</option>
          <option value="CdTe">Cadmium Telluride (CdTe)</option>
          <option value="PbSe">Lead Selenide (PbSe)</option>
          <option value="Bi2Se3">Bismuth Selenide (Bi‚ÇÇSe‚ÇÉ)</option>
          <option value="MoSe2">Molybdenum Diselenide (MoSe‚ÇÇ)</option>
          <option value="WSe2">Tungsten Diselenide (WSe‚ÇÇ)</option>
          <option value="SnSe">Tin Selenide (SnSe)</option>
          <option value="Sb2Se3">Antimony Selenide (Sb‚ÇÇSe‚ÇÉ)</option>
          <option value="Cu2Se">Copper Selenide (Cu‚ÇÇSe)</option>
          <option value="Ag2Se">Silver Selenide (Ag‚ÇÇSe)</option>
        </optgroup>
        <optgroup label="üíé Perovskites (15 materials)">
          <option value="CsPbBr3">Cesium Lead Bromide (CsPbBr‚ÇÉ)</option>
          <option value="CsPbI3">Cesium Lead Iodide (CsPbI‚ÇÉ)</option>
          <option value="CsPbCl3">Cesium Lead Chloride (CsPbCl‚ÇÉ)</option>
          <option value="MAPbI3">Methylammonium Lead Iodide</option>
          <option value="FAPbI3">Formamidinium Lead Iodide</option>
          <option value="CsSnI3">Cesium Tin Iodide (CsSnI‚ÇÉ)</option>
          <option value="LaCoO3">Lanthanum Cobaltite (LaCoO‚ÇÉ)</option>
          <option value="LaNiO3">Lanthanum Nickelate (LaNiO‚ÇÉ)</option>
          <option value="SrTiO3-NPs">SrTiO‚ÇÉ Nanoparticles</option>
          <option value="BaTiO3-NPs">BaTiO‚ÇÉ Nanoparticles</option>
          <option value="CaTiO3">Calcium Titanate (CaTiO‚ÇÉ)</option>
          <option value="PbTiO3">Lead Titanate (PbTiO‚ÇÉ)</option>
          <option value="BiFeO3">Bismuth Ferrite (BiFeO‚ÇÉ)</option>
          <option value="LaAlO3">Lanthanum Aluminate (LaAlO‚ÇÉ)</option>
          <option value="NdGaO3">Neodymium Gallate (NdGaO‚ÇÉ)</option>
        </optgroup>
        <optgroup label="üñ§ Carbon-based (20 materials)">
          <option value="gC3N4">Graphitic Carbon Nitride (g-C‚ÇÉN‚ÇÑ)</option>
          <option value="C3N4x">C‚ÇÉN‚ÇÑ Derivative</option>
          <option value="BlackP">Black Phosphorus</option>
          <option value="Graphene">Graphene</option>
          <option value="CNT">Carbon Nanotubes</option>
          <option value="Fullerene">Fullerene (C‚ÇÜ‚ÇÄ/C‚Çá‚ÇÄ)</option>
          <option value="GrapheneOxide">Graphene Oxide</option>
          <option value="ReducedGO">Reduced Graphene Oxide</option>
          <option value="CarbonDots">Carbon Dots</option>
          <option value="Graphdiyne">Graphdiyne</option>
          <option value="CNT-MWCNT">Multi-Walled CNT</option>
          <option value="CNT-SWCNT">Single-Walled CNT</option>
          <option value="C60">Buckminsterfullerene (C‚ÇÜ‚ÇÄ)</option>
          <option value="C70">C‚Çá‚ÇÄ Fullerene</option>
          <option value="GrapheneNR">Graphene Nanoribbons</option>
          <option value="N-Graphene">Nitrogen-Doped Graphene</option>
          <option value="B-Graphene">Boron-Doped Graphene</option>
          <option value="S-Graphene">Sulfur-Doped Graphene</option>
          <option value="P-Graphene">Phosphorus-Doped Graphene</option>
          <option value="Graphyne">Graphyne</option>
        </optgroup>
        <optgroup label="‚ú® Noble Metal Decorated (15 materials)">
          <option value="Pt/TiO2">Pt/TiO‚ÇÇ</option>
          <option value="Au/TiO2">Au/TiO‚ÇÇ</option>
          <option value="Pd/CuO">Pd/CuO</option>
          <option value="Ag/TiO2">Ag/TiO‚ÇÇ</option>
          <option value="Au/ZnO">Au/ZnO</option>
          <option value="Pt/gC3N4">Pt/g-C‚ÇÉN‚ÇÑ</option>
          <option value="Pd/BiVO4">Pd/BiVO‚ÇÑ</option>
          <option value="Ru/TiO2">Ru/TiO‚ÇÇ</option>
          <option value="Rh/TiO2">Rh/TiO‚ÇÇ</option>
          <option value="Ag/BiVO4">Ag/BiVO‚ÇÑ</option>
          <option value="Au/CdS">Au/CdS</option>
          <option value="Pt/WO3">Pt/WO‚ÇÉ</option>
          <option value="Pd/ZnO">Pd/ZnO</option>
          <option value="Ag/gC3N4">Ag/g-C‚ÇÉN‚ÇÑ</option>
          <option value="Au/MoS2">Au/MoS‚ÇÇ</option>
        </optgroup>
        <optgroup label="üîß Nitrides & Phosphides (15 materials)">
          <option value="TiN">Titanium Nitride (TiN)</option>
          <option value="NbN">Niobium Nitride (NbN)</option>
          <option value="GaN">Gallium Nitride (GaN)</option>
          <option value="Ta3N5">Tantalum Nitride (Ta‚ÇÉN‚ÇÖ)</option>
          <option value="InN">Indium Nitride (InN)</option>
          <option value="AlN">Aluminum Nitride (AlN)</option>
          <option value="Ni2P">Nickel Phosphide (Ni‚ÇÇP)</option>
          <option value="CoP">Cobalt Phosphide (CoP)</option>
          <option value="FeP">Iron Phosphide (FeP)</option>
          <option value="Cu3P">Copper Phosphide (Cu‚ÇÉP)</option>
          <option value="MoN">Molybdenum Nitride (MoN)</option>
          <option value="WN">Tungsten Nitride (WN)</option>
          <option value="VN">Vanadium Nitride (VN)</option>
          <option value="CrN">Chromium Nitride (CrN)</option>
          <option value="ZrN">Zirconium Nitride (ZrN)</option>
        </optgroup>
        <optgroup label="üèóÔ∏è MOFs & Hybrid (10 materials)">
          <option value="UiO66">UiO-66</option>
          <option value="MIL101">MIL-101</option>
          <option value="ZIF8">ZIF-8</option>
          <option value="HKUST1">HKUST-1</option>
          <option value="MOF5">MOF-5</option>
          <option value="PCN222">PCN-222</option>
          <option value="MXeneTi3C2">MXene (Ti‚ÇÉC‚ÇÇ)</option>
          <option value="MXeneV2C">MXene (V‚ÇÇC)</option>
          <option value="COF-1">COF-1</option>
          <option value="ZIF-67">ZIF-67</option>
        </optgroup>
        <optgroup label="üåü Advanced Materials (20 materials)">
          <option value="BiOCl">Bismuth Oxychloride (BiOCl)</option>
          <option value="BiOBr">Bismuth Oxybromide (BiOBr)</option>
          <option value="BiOI">Bismuth Oxyiodide (BiOI)</option>
          <option value="WO3-x">Oxygen-deficient WO‚ÇÉ-x</option>
          <option value="MoOx">Molybdenum Oxide (MoO‚Çì)</option>
          <option value="ReO3">Rhenium Trioxide (ReO‚ÇÉ)</option>
          <option value="Ag3PO4">Silver Phosphate (Ag‚ÇÉPO‚ÇÑ)</option>
          <option value="Ag2O">Silver Oxide (Ag‚ÇÇO)</option>
          <option value="CuWO4">Copper Tungstate (CuWO‚ÇÑ)</option>
          <option value="CuBi2O4">Copper Bismuth Oxide (CuBi‚ÇÇO‚ÇÑ)</option>
          <option value="ZnWO4">Zinc Tungstate (ZnWO‚ÇÑ)</option>
          <option value="AgBr">Silver Bromide (AgBr)</option>
          <option value="AgCl">Silver Chloride (AgCl)</option>
          <option value="AgI">Silver Iodide (AgI)</option>
          <option value="BiPO4">Bismuth Phosphate (BiPO‚ÇÑ)</option>
          <option value="Bi4Ti3O12">Bismuth Titanate</option>
          <option value="CaBi2O4">Calcium Bismuth Oxide</option>
          <option value="ZnV2O6">Zinc Vanadate (ZnV‚ÇÇO‚ÇÜ)</option>
          <option value="BiVO4-NPs">BiVO‚ÇÑ Nanoparticles</option>
          <option value="Fe2TiO5">Iron Titanate (Fe‚ÇÇTiO‚ÇÖ)</option>
        </optgroup>
      </select>
      <div class="hint">üí° Hold Ctrl (Windows) or ‚åò (Mac) to select multiple materials for composite optimization</div>
      <button class="select-all-btn" onclick="selectAllMaterials()">Select All</button>
      <button class="select-all-btn" onclick="clearMaterials()">Clear All</button>

      <label>Target Band Gap <span id="bandgapValue">2.5 eV</span></label>
      <input id="targetBandgap" type="range" min="1.5" max="4.0" step="0.1" value="2.5">

      <label>Surface Area <span id="surfaceValue">100 m¬≤/g</span></label>
      <input id="surfaceArea" type="range" min="50" max="300" step="10" value="100">

      <label>Particle Size <span id="sizeValue">70 nm</span></label>
      <input id="particleSize" type="range" min="10" max="200" step="5" value="70">

      <label>Quantum Circuit Depth</label>
      <select id="circuitDepth">
        <option value="2">Level 2 ‚Äì Fast (6 qubits)</option>
        <option value="3">Level 3 ‚Äì Balanced (10 qubits)</option>
        <option value="4" selected>Level 4 ‚Äì Accurate (15 qubits)</option>
        <option value="5">Level 5 ‚Äì Maximum (20 qubits)</option>
      </select>

      <div class="depth-info">
        <div class="depth-card" data-level="2">
          <div class="depth-level">Level 2</div>
          <div class="depth-qubits">6 Qubits</div>
        </div>
        <div class="depth-card" data-level="3">
          <div class="depth-level">Level 3</div>
          <div class="depth-qubits">10 Qubits</div>
        </div>
        <div class="depth-card active" data-level="4">
          <div class="depth-level">Level 4</div>
          <div class="depth-qubits">15 Qubits</div>
        </div>
        <div class="depth-card" data-level="5">
          <div class="depth-level">Level 5</div>
          <div class="depth-qubits">20 Qubits</div>
        </div>
      </div>

      <button id="optimizeBtn" class="btn">üöÄ Run Quantum Optimization</button>
    </section>

    <section class="panel">
      <h3>‚öõÔ∏è Quantum Circuit & Results</h3>
      <div id="circuitContainer" class="circuit">
        <div id="circuitMsg">Run optimization to visualize quantum circuit and results</div>
      </div>

      <div id="resultBox" class="results" style="display:none"></div>

      <div id="downloadSection" class="download-section" style="display:none">
        <button class="download-btn" onclick="downloadResults()">üì• JSON Data</button>
        <button class="download-btn" onclick="downloadCircuitImage()">üñºÔ∏è Circuit PNG</button>
        <button class="download-btn excel" onclick="downloadExcel()">üìä Excel Report</button>
        <button class="download-btn" onclick="downloadReport()">üìÑ Text Report</button>
      </div>
    </section>
  </main>

  <footer>‚ö° Quantum Photocatalyst Optimizer v2.0 ‚Ä¢ 150+ Nanomaterials ‚Ä¢ Excel Export Enabled</footer>

  <script>
    let lastResults = null;
    let lastCircuitImage = null;

    const bandgapRange = document.getElementById('targetBandgap');
    const surfaceRange = document.getElementById('surfaceArea');
    const sizeRange = document.getElementById('particleSize');
    const bandgapValue = document.getElementById('bandgapValue');
    const surfaceValue = document.getElementById('surfaceValue');
    const sizeValue = document.getElementById('sizeValue');
    const circuitDepthSelect = document.getElementById('circuitDepth');

    bandgapRange.addEventListener('input', ()=> bandgapValue.textContent = bandgapRange.value + ' eV');
    surfaceRange.addEventListener('input', ()=> surfaceValue.textContent = surfaceRange.value + ' m¬≤/g');
    sizeRange.addEventListener('input', ()=> sizeValue.textContent = sizeRange.value + ' nm');

    // Update selected materials count
    document.getElementById('materialType').addEventListener('change', function() {
      const count = this.selectedOptions.length;
      document.getElementById('selectedCount').textContent = count;
    });

    // Update qubit count display
    circuitDepthSelect.addEventListener('change', function() {
      const depthMap = {2: 6, 3: 10, 4: 15, 5: 20};
      const qubits = depthMap[parseInt(this.value)] || 15;
      document.getElementById('qubitCount').textContent = qubits;
      
      // Update active depth card
      document.querySelectorAll('.depth-card').forEach(card => {
        card.classList.remove('active');
        if (card.dataset.level === this.value) {
          card.classList.add('active');
        }
      });
    });

    function selectAllMaterials() {
      const sel = document.getElementById('materialType');
      for (let option of sel.options) {
        option.selected = true;
      }
      document.getElementById('selectedCount').textContent = sel.options.length;
    }

    function clearMaterials() {
      const sel = document.getElementById('materialType');
      for (let option of sel.options) {
        option.selected = false;
      }
      document.getElementById('selectedCount').textContent = 0;
    }

    document.getElementById('optimizeBtn').addEventListener('click', async () => {
      const sel = document.getElementById('materialType');
      const selected = Array.from(sel.selectedOptions).map(o => o.value);
      
      if (selected.length === 0) {
        alert('‚ö†Ô∏è Please select at least one material!');
        return;
      }

      const params = {
        materials: selected,
        targetBandgap: parseFloat(bandgapRange.value),
        surfaceArea: parseFloat(surfaceRange.value),
        particleSize: parseFloat(sizeRange.value),
        circuitDepth: parseInt(circuitDepthSelect.value, 10)
      };

      const btn = document.getElementById('optimizeBtn');
      btn.textContent = '‚öôÔ∏è Optimizing...'; 
      btn.disabled = true;

      try {
        const res = await fetch('/optimize', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify(params)
        });
        const data = await res.json();
        btn.textContent = 'üöÄ Run Quantum Optimization'; 
        btn.disabled = false;

        if(!data.success){ 
          alert('Error: '+(data.error||'unknown')); 
          return; 
        }

        lastResults = data;
        lastCircuitImage = data.circuit_image;

        const container = document.getElementById('circuitContainer');
        container.innerHTML = `<img src="data:image/png;base64,${data.circuit_image}" style="max-width:100%;border-radius:8px;">`;

        const box = document.getElementById('resultBox');
        box.style.display = 'block';
        box.innerHTML = `
          <div style="margin-bottom:12px">
            <strong>Selected Materials:</strong> ${data.materials.join(', ')}
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:12px">
            <div><strong>Qubits:</strong> ${data.num_qubits}</div>
            <div><strong>Depth:</strong> Level ${data.circuit_depth}</div>
            <div><strong>Energy:</strong> ${data.final_energy.toFixed(4)}</div>
          </div>
          <div style="background:rgba(0,216,255,0.05);padding:12px;border-radius:6px;border-left:3px solid var(--accent1)">
            <div style="margin-bottom:8px"><strong>üìä Performance Metrics:</strong></div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:14px">
              <div>üéØ Bandgap: <strong>${data.optimized_params.bandgap.toFixed(2)} eV</strong></div>
              <div>‚ö° Efficiency: <strong>${data.optimized_params.efficiency.toFixed(1)}%</strong></div>
              <div>üåà Absorption: <strong>${data.optimized_params.absorption.toFixed(1)}%</strong></div>
              <div>‚ú® Quantum Yield: <strong>${data.optimized_params.quantum_yield.toFixed(1)}%</strong></div>
              <div style="grid-column:1/-1">üõ°Ô∏è Stability: <strong>${data.optimized_params.stability.toFixed(1)}%</strong></div>
            </div>
          </div>
          <p style="margin-top:12px;color:#a7dffb;font-style:italic;border-top:1px solid rgba(0,216,255,0.1);padding-top:12px">
            ${data.analysis}
          </p>
        `;

        document.getElementById('downloadSection').style.display = 'grid';

      } catch(err){
        btn.textContent = 'üöÄ Run Quantum Optimization'; 
        btn.disabled = false;
        alert('‚ùå Network/Server error: '+err);
      }
    });

    function downloadResults() {
      if (!lastResults) {
        alert('No results available. Please run optimization first.');
        return;
      }
      
      const dataStr = JSON.stringify(lastResults, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `quantum_optimization_${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function downloadCircuitImage() {
      if (!lastCircuitImage) {
        alert('No circuit image available. Please run optimization first.');
        return;
      }

      const a = document.createElement('a');
      a.href = `data:image/png;base64,${lastCircuitImage}`;
      a.download = `quantum_circuit_${Date.now()}.png`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    async function downloadExcel() {
      if (!lastResults) {
        alert('No results available. Please run optimization first.');
        return;
      }

      try {
        const res = await fetch('/download/excel', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(lastResults)
        });

        if (!res.ok) {
          throw new Error('Failed to generate Excel file');
        }

        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `quantum_optimization_${Date.now()}.xlsx`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      } catch(err) {
        alert('Error downloading Excel file: ' + err.message);
      }
    }

    function downloadReport() {
      if (!lastResults) {
        alert('No results available. Please run optimization first.');
        return;
      }

      const report = `
QUANTUM PHOTOCATALYST OPTIMIZATION REPORT
=========================================
Generated: ${new Date().toLocaleString()}

MATERIALS CONFIGURATION
-----------------------
Selected Materials: ${lastResults.materials.join(', ')}
Number of Materials: ${lastResults.materials.length}

QUANTUM CIRCUIT PARAMETERS
--------------------------
Number of Qubits: ${lastResults.num_qubits}
Circuit Depth Level: ${lastResults.circuit_depth}
Final Ground State Energy: ${lastResults.final_energy.toFixed(6)}

MATERIAL PROPERTIES
-------------------
Surface Area: ${lastResults.surface_area} m¬≤/g
Particle Size: ${lastResults.particle_size} nm

OPTIMIZED PERFORMANCE METRICS
------------------------------
Target Bandgap: ${lastResults.optimized_params.bandgap.toFixed(2)} eV
Photocatalytic Efficiency: ${lastResults.optimized_params.efficiency.toFixed(2)}%
Light Absorption: ${lastResults.optimized_params.absorption.toFixed(2)}%
Quantum Yield: ${lastResults.optimized_params.quantum_yield.toFixed(2)}%
Material Stability: ${lastResults.optimized_params.stability.toFixed(2)}%

ANALYSIS
--------
${lastResults.analysis}

OPTIMIZATION HISTORY
--------------------
Total Iterations: ${lastResults.history.length}
Initial Energy: ${lastResults.history[0].toFixed(6)}
Final Energy: ${lastResults.history[lastResults.history.length-1].toFixed(6)}
Energy Reduction: ${(lastResults.history[0] - lastResults.history[lastResults.history.length-1]).toFixed(6)}

CONVERGENCE DATA (First 10 iterations)
---------------------------------------
${lastResults.history.slice(0, 10).map((e, i) => `Iteration ${i}: ${e.toFixed(6)}`).join('\n')}

=========================================
Report generated by Quantum Photocatalyst Optimizer v2.0
Powered by Qiskit Quantum Computing Framework
      `.trim();

      const blob = new Blob([report], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `quantum_optimization_report_${Date.now()}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // Initialize display
    document.getElementById('selectedCount').textContent = 1; // TiO2 is selected by default
  </script>
</body>
</html>
